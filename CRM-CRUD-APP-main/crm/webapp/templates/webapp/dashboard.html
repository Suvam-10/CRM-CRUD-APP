{% extends 'webapp/base.html' %}

{% block content %}

    <h5> Welcome to the CRM Dashboard üöÄ {{ user }} </h5>
    <hr>

    <!-- Search Bar -->
    <form method="GET" action="{% url 'dashboard' %}" class="mb-3">
        <div class="input-group">
            <input type="text" name="search" class="form-control" placeholder="Search records..." value="{{ query }}">
            <button type="submit" class="btn btn-primary">üîç Search</button>
        </div>
    </form>

    <a class="btn btn-outline-primary btn-sm" href="{% url 'create-record' %}">
        Create a New Record &nbsp; <i class="fa fa-plus-circle" aria-hidden="true"></i>
    </a>
    <hr>

    <table class="table table-hover table-bordered">
        <thead class="table-light">
            <tr>
                <th scope="col">ID</th>
                <th scope="col">Fullname</th>
                <th scope="col">Email</th>
                <th scope="col">Phone</th>
                <th scope="col">Address</th>
                <th scope="col">City</th>
                <th scope="col">Province</th>
                <th scope="col">Country</th>
                <th scope="col">Date Joined</th>
                <th scope="col">View</th>
            </tr>
        </thead>

        <tbody>
            {% if records %}
                {% for record in records %}
                    <tr>
                        <td>{{ record.id }}</td>
                        <td>{{ record.first_name }} {{ record.last_name }}</td>
                        <td>{{ record.email }}</td>
                        <td>{{ record.phone }}</td>
                        <td>{{ record.address }}</td>
                        <td>{{ record.city }}</td>
                        <td>{{ record.province }}</td>
                        <td>{{ record.country }}</td>
                        <td>{{ record.creation_date }}</td>
                        <td><a class="btn btn-success btn-sm" href="{% url 'record' record.id %}">  <i class="fa fa-eye" aria-hidden="true"></i></a></td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="10" class="text-center">No records found.</td>
                </tr>
            {% endif %}
        </tbody>
    </table>

{% endblock %}
